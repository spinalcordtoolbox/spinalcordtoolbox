# NB: Any lines marked with 'append_to_freeze' will be copied over to `requirements-freeze.txt` when creating SCT's
#     stable releases. We do this because `pip freeze` will not capture options (e.g. --extra-index-url) or
#     platform-specific requirements (e.g. sys.platform == 'win32')

# Avoid method=restore bug: https://github.com/spinalcordtoolbox/spinalcordtoolbox/issues/4209#issuecomment-1739644328
dipy!=1.6.*,!=1.7.*
# PyTorch's Linux distribution is very large due to its GPU support,
# but we only need that for training models. Our users only need CPU.
--extra-index-url https://download.pytorch.org/whl/cpu # append_to_freeze
ivadomed
matplotlib
# Fresh Windows installations may be missing the C++ runtime library required by scikit-image.
# Installing "Microsoft Visual C++ Redistributable for Visual Studio" will fix this too, but
# we'd prefer not to burden users with another prerequisite.
# NB: It's possible this fix gets included upstream in a future skimage release, see:
#     https://github.com/scikit-image/scikit-image/issues/4780#issuecomment-824678872
# (The version is pinned because this line gets copied to requirements-freeze.txt when preparing a release, not because we're avoiding bugs with a specific version. Feel free to update it to the latest version.)
msvc-runtime==14.29.30133; sys.platform == 'win32' # append_to_freeze
nibabel
nilearn
# This pin is due to an incompatibility with pystrum==0.2, which is installed via voxelmorph -> neurite -> pystrum
# See also: https://github.com/adalca/pystrum/issues/9
# If pystrum is updated to 0.3, then we should replace this version pinning with `pystrum>=0.3`
numpy<1.24
# 1.7.0>onnxruntime>=1.5.1 required `brew install libomp` on macOS.
# So, pin to >=1.7.0 to avoid having to ask users to install libomp.
# Avoid version 1.16.0 due to: https://github.com/spinalcordtoolbox/spinalcordtoolbox/issues/4225
onnxruntime>=1.7.0,!=1.16.0
pandas
portalocker
psutil
# pyqt5=5.11.X causes https://github.com/spinalcordtoolbox/spinalcordtoolbox/pull/3916#discussion_r997435037
# pyqt5=5.15.X causes https://github.com/spinalcordtoolbox/spinalcordtoolbox/issues/3925
# Additionally, for versions between 5.12-5.14, the only release to have Python 3.9 wheels is 5.12.3. So, we pin it.
# See: https://github.com/spinalcordtoolbox/spinalcordtoolbox/issues/3367#issuecomment-1533181462
pyqt5==5.12.3
pytest
pytest-cov
requests
requirements-parser
scipy
scikit-image
scikit-learn
xlwt
tqdm
transforms3d
urllib3
pytest_console_scripts
pyyaml
voxelmorph
wquantiles
# XlxsWriter is needed to write `.xlsx` files, since pandas removed support for the `xlwt` engine
# Source: https://github.com/pandas-dev/pandas/pull/49296
xlsxwriter
# Minimum necessary dependencies for nnUNet-based models
nnunetv2
# Minimum necessary dependencies for MONAI-based models
# See: https://github.com/sct-pipeline/contrast-agnostic-softseg-spinalcord/blob/main/monai/requirements_inference_cpu.txt
dynamic_network_architectures
monai[nibabel]
# Note that the above requirements file also contains additional dependencies:
#   joblib==1.3.0
#   loguru==0.7.0
#   scipy==1.11.2
#   numpy==1.24.4
#   torch==2.0.0
#   --extra-index-url https://download.pytorch.org/whl/cpu
# However, I'm not fully convinced that it's necessary to explicitly specify/pin these dependencies. So,
# I'm starting out by simply adding monai and dynamic_network_architectures and nothing else.
