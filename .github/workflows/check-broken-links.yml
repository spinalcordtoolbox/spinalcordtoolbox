name: Check for broken links

on:
  schedule:
    - cron:  '0 10 * * *'

jobs:
  check_broken_links:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4

    - name: Check for broken links
      # We use '-print0 | xargs' instead of '-exec' to make sure that
      # check-broken-links.sh gets run at least once, so that we get its
      # summary output
      run: |
        find \
          -type d \( -path ./.git -o -path ./python \) -prune -o \
          -type f \( -name '*.txt' -o -name '*.md' -o -name '*.py' -o -name '*.rst' \) \
          -print0 | xargs -0 .github/workflows/check-broken-links.sh
