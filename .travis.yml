# testing file for Travis
# https://travis-ci.org/neuropoly/spinalcordtoolbox

notifications:
  slack: neuropoly:YA3mt28aeHN3A0Iu7RvMFigK
    on_success:change
    on_failure:always

# this enables to avoid recompilation of dipy if it was already compiled previously
#cache:
#  directories:
#    - ${HOME}/.cache/pip

matrix:
  include:
    # To support OSes that Travis doesn't, we mix in Docker images.
    # Any such OS (CentOS, etc) will be booted in docker instead.
    # OSes in this case are marked by using DOCKER_IMAGE: instead of dist:.
    #
    # Since Docker images are usually very barebones,
    # these need a DEPS command that should install the
    # basic dependencies needed for conda etc.
    #
    # Testing this way is imperfect -- these docker images are not
    # identical to freshly installed VMs, and by using docker we're
    # mismatching kernels, but it is a lot better than not testing.
    - os: linux
      dist: bionic  # Arch needs a recent kernel
      services:
        - docker
      name: "ArchLinux"
      env:
        - DOCKER_IMAGE="archlinux" DOCKER_DEPS_CMD="pacman -Sy --noconfirm which gcc git curl"
    - os: linux
      dist: bionic # kernel ~= Centos8
      services:
        - docker
      name: "CentOS 8"
      env:
        - DOCKER_IMAGE="centos:8" DOCKER_DEPS_CMD="yum install -y which gcc git curl"
    - os: linux
      dist: xenial # kernel ~= Centos7
      services:
        - docker
      name: "CentOS 7"
      env:
        - DOCKER_IMAGE="centos:7" DOCKER_DEPS_CMD="yum install -y which gcc git curl"
    # The rest of the OSes can use Travis's built-in images:
    - os: linux  # list of Linux env: https://docs.travis-ci.com/user/reference/overview/
      name: "Ubuntu 18.04 (Bionic Beaver)"
      dist: bionic
    - os: linux
      name: "Ubuntu 16.04 (Xenial)"
      dist: xenial
    - os: linux
      name: "Ubuntu 14.04 (Trusty)"
      dist: trusty
    - os: osx  # list of OSX env: https://docs.travis-ci.com/user/reference/osx/
      name: "OSX 10.14 (Mojave)"
      osx_image: xcode11.2
    - os: osx
      name: "OSX 10.13 (High Sierra)"
      osx_image: xcode9.4
    - os: osx
      name: "OSX 10.12 (Sierra)"
      osx_image: xcode9.2

script: ./.travis.sh
